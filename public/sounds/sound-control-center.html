<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎵 CRM Sound Control Center - 150+ Professional Sounds</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.8rem;
            background: linear-gradient(45deg, #00d4ff, #ff6b6b, #4ecdc4, #FFD700);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
            color: #b0b0b0;
        }

        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .panel-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #00d4ff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #FFD700;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .control-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 13px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .control-btn:hover {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
        }

        .volume-slider {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.3);
            outline: none;
            cursor: pointer;
        }

        .themes-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .theme-card {
            background: rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-card:hover {
            border-color: rgba(0, 212, 255, 0.5);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.2);
        }

        .theme-card.active {
            border-color: #00d4ff;
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.4);
        }

        .theme-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .theme-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00d4ff;
        }

        .theme-badge {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            color: #000;
        }

        .sounds-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .sound-card {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transition: all 0.3s ease;
        }

        .sound-card:hover {
            border-color: #00d4ff;
            background: rgba(0, 0, 0, 0.6);
            transform: scale(1.02);
        }

        .sound-card.playing {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.2);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 107, 107, 0.4); }
            50% { box-shadow: 0 0 30px rgba(255, 107, 107, 0.8); }
        }

        .sound-name {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
            color: #ffffff;
        }

        .sound-status {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 12px;
        }

        .sound-controls {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .sound-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.2s ease;
            flex: 1;
        }

        .sound-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .sound-btn.stop {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
        }

        .mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
        }

        .toggle-btn {
            padding: 10px 15px;
            margin: 0 5px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .toggle-btn.active {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
        }

        .view-mode.browser .stats-grid {
            grid-template-columns: repeat(4, 1fr);
        }

        .view-mode.manager .control-panel {
            grid-template-columns: repeat(3, 1fr);
        }

        @media (max-width: 768px) {
            .themes-container {
                grid-template-columns: 1fr;
            }
            
            .sounds-grid {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .mode-toggle {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
            }
        }

        .floating-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
            min-width: 280px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .quick-btn {
            padding: 10px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .quick-btn:hover {
            transform: scale(1.05);
        }

        /* Edit Mode Styles */
        .edit-mode .theme-card {
            border: 2px dashed rgba(255, 255, 255, 0.3);
        }

        .edit-mode .sound-card {
            cursor: grab;
            user-select: none;
        }

        .edit-mode .sound-card:hover {
            transform: scale(1.05);
            z-index: 10;
        }

        .edit-mode .sound-card.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
            cursor: grabbing;
        }

        .sound-card.editable {
            position: relative;
        }

        .sound-card.editable::after {
            content: "✏️";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 12px;
            opacity: 0.7;
        }

        .edit-controls {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
            min-width: 200px;
        }

        .edit-mode .edit-controls {
            display: block;
        }

        .save-btn {
            padding: 12px 20px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            margin: 5px 0;
            width: 100%;
        }

        .reset-btn {
            padding: 12px 20px;
            background: linear-gradient(45deg, #f44336, #d32f2f);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            margin: 5px 0;
            width: 100%;
        }

        .sound-selector {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            border: 2px solid #00d4ff;
        }

        .sound-selector.active {
            display: block;
        }

        .selector-header {
            text-align: center;
            margin-bottom: 20px;
            color: #00d4ff;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .available-sounds {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .available-sound {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .available-sound:hover {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

        .changes-indicator {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background: rgba(255, 107, 107, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: 600;
            display: none;
            animation: pulse 2s infinite;
        }

        .changes-indicator.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="mode-toggle">
        <button class="toggle-btn active" onclick="setViewMode('manager')">🎛️ Manager</button>
        <button class="toggle-btn" onclick="setViewMode('browser')">🎵 Browser</button>
        <button class="toggle-btn" onclick="toggleEditMode()">✏️ Edit</button>
    </div>

    <div class="edit-controls">
        <div style="color: #00d4ff; font-weight: 600; margin-bottom: 10px;">🎛️ Edit Mode Active</div>
        <button class="save-btn" onclick="saveConfiguration()">💾 Save Changes</button>
        <button class="reset-btn" onclick="resetToDefault()">🔄 Reset All</button>
        <button class="toggle-btn" onclick="toggleEditMode()" style="background: #f44336; width: 100%;">❌ Exit Edit</button>
    </div>

    <div class="overlay" id="overlay" onclick="closeSoundSelector()"></div>
    <div class="sound-selector" id="soundSelector">
        <div class="selector-header">Select Sound for <span id="targetSlot"></span></div>
        <div class="available-sounds" id="availableSounds">
            <!-- Available sounds will be populated here -->
        </div>
        <div style="text-align: center; margin-top: 20px;">
            <button class="toggle-btn" onclick="closeSoundSelector()">Cancel</button>
        </div>
    </div>

    <div class="changes-indicator" id="changesIndicator">
        🔥 Unsaved Changes
    </div>

    <div class="header">
        <h1>🎵 CRM Sound Control Center</h1>
        <p>Professional Audio Management & Browser - 150+ High-Quality Themed Sounds</p>
    </div>

    <div class="control-panel">
        <div class="panel-section">
            <div class="section-title">📊 Live Statistics</div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="totalSounds">150+</div>
                    <div class="stat-label">Total Sounds</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalThemes">10</div>
                    <div class="stat-label">Themes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="playingSounds">0</div>
                    <div class="stat-label">Playing</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="loadedSounds">0</div>
                    <div class="stat-label">Loaded</div>
                </div>
            </div>
        </div>

        <div class="panel-section">
            <div class="section-title">🎛️ Master Controls</div>
            <div class="controls-grid">
                <button class="control-btn" onclick="testAllSounds()">🧪 Test All</button>
                <button class="control-btn" onclick="stopAllSounds()">⏹️ Stop All</button>
                <button class="control-btn" onclick="playRandomSamples()">🎲 Random</button>
                <button class="control-btn" onclick="exportConfiguration()">💾 Export</button>
            </div>
        </div>

        <div class="panel-section">
            <div class="section-title">🔊 Volume Control</div>
            <div class="volume-control">
                <span>🔇</span>
                <input type="range" class="volume-slider" id="masterVolume" min="0" max="100" value="70">
                <span>🔊</span>
                <span id="volumeDisplay">70%</span>
            </div>
        </div>
    </div>

    <div class="themes-container" id="themesContainer">
        <!-- Theme cards will be generated here -->
    </div>

    <div class="floating-controls">
        <div class="section-title">⚡ Quick Actions</div>
        <div class="quick-actions">
            <button class="quick-btn" onclick="muteAll()">🔇 Mute</button>
            <button class="quick-btn" onclick="maxVolume()">🔊 Max</button>
            <button class="quick-btn" onclick="resetVolume()">🎚️ Reset</button>
            <button class="quick-btn" onclick="showAdvancedStats()">📈 Stats</button>
        </div>
    </div>

    <script>
        class SoundControlCenter {
            constructor() {
                this.sounds = new Map();
                this.playingSounds = new Set();
                this.masterVolume = 0.7;
                this.loadedCount = 0;
                this.viewMode = 'manager';
                this.soundMappings = {};
                this.init();
            }

            async init() {
                this.loadSoundMappings();
                this.setupEventListeners();
                this.renderThemes();
                this.updateStats();
                this.setViewMode('manager');
            }

            loadSoundMappings() {
                this.soundMappings = {
                    "core": {
                        name: "🎯 Core UI Sounds",
                        sounds: {
                            "ui-click-primary": "/sounds/core/ui-click-primary.wav",
                            "ui-click-metal": "/sounds/core/ui-click-metal.wav",
                            "ui-click-secondary": "/sounds/core/ui-click-secondary.mp3",
                            "ui-hover": "/sounds/core/ui-hover.wav",
                            "ui-toggle": "/sounds/core/ui-toggle.mp3",
                            "navigation-forward": "/sounds/core/navigation-forward.wav",
                            "navigation-back": "/sounds/core/navigation-back.wav",
                            "notification-success": "/sounds/core/notification-success.wav",
                            "notification-error": "/sounds/core/notification-error.wav",
                            "gauge-tick": "/sounds/core/gauge-tick.wav",
                            "diamond-click": "/sounds/core/diamond-click.wav",
                            "door-close": "/sounds/core/door-close.wav",
                            "message-sent": "/sounds/core/message-sent.ogg",
                            "save-success": "/sounds/core/save-success.wav"
                        }
                    },
                    "corporate-professional": {
                        name: "🏢 Corporate Professional",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/corporate-professional/click-professional-refined.wav",
                            "ui-click-secondary": "/sounds/themes/corporate-professional/click-business-subtle.wav",
                            "ui-hover": "/sounds/themes/corporate-professional/hover-executive-smooth.wav",
                            "ui-toggle": "/sounds/themes/corporate-professional/toggle-corporate-click.wav",
                            "navigation-forward": "/sounds/themes/corporate-professional/forward-boardroom-advance.wav",
                            "navigation-back": "/sounds/themes/corporate-professional/back-office-retreat.wav",
                            "notification-success": "/sounds/themes/corporate-professional/success-achievement-chime.wav",
                            "notification-error": "/sounds/themes/corporate-professional/error-corporate-alert.wav",
                            "gauge-tick": "/sounds/themes/corporate-professional/tick-precision-measurement.wav",
                            "diamond-click": "/sounds/themes/corporate-professional/click-luxury-crystal.wav",
                            "door-close": "/sounds/themes/corporate-professional/close-executive-door.wav",
                            "message-sent": "/sounds/themes/corporate-professional/sent-professional-communication.wav"
                        }
                    },
                    "f16-viper": {
                        name: "✈️ F-16 Viper",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/f16-viper/click-tactical-engage.wav",
                            "ui-click-secondary": "/sounds/themes/f16-viper/click-systems-activate.wav",
                            "ui-hover": "/sounds/themes/f16-viper/hover-radar-sweep.wav",
                            "ui-toggle": "/sounds/themes/f16-viper/toggle-weapon-systems.wav",
                            "navigation-forward": "/sounds/themes/f16-viper/forward-afterburner-thrust.wav",
                            "navigation-back": "/sounds/themes/f16-viper/back-tactical-retreat.wav",
                            "notification-success": "/sounds/themes/f16-viper/success-mission-complete.wav",
                            "notification-error": "/sounds/themes/f16-viper/error-system-warning.wav",
                            "gauge-tick": "/sounds/themes/f16-viper/tick-altimeter-reading.wav",
                            "diamond-click": "/sounds/themes/f16-viper/click-targeting-lock.wav",
                            "door-close": "/sounds/themes/f16-viper/close-cockpit-seal.wav",
                            "message-sent": "/sounds/themes/f16-viper/sent-radio-transmission.wav"
                        }
                    },
                    "luxury-hermes": {
                        name: "👜 Luxury Hermès",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/luxury-hermes/click-silk-whisper.wav",
                            "ui-click-secondary": "/sounds/themes/luxury-hermes/click-leather-caress.wav",
                            "ui-hover": "/sounds/themes/luxury-hermes/hover-boutique-elegance.wav",
                            "ui-toggle": "/sounds/themes/luxury-hermes/toggle-clasp-precision.wav",
                            "navigation-forward": "/sounds/themes/luxury-hermes/forward-paris-promenade.wav",
                            "navigation-back": "/sounds/themes/luxury-hermes/back-atelier-return.wav",
                            "notification-success": "/sounds/themes/luxury-hermes/success-artisan-approval.wav",
                            "notification-error": "/sounds/themes/luxury-hermes/error-quality-concern.wav",
                            "gauge-tick": "/sounds/themes/luxury-hermes/tick-watch-precision.wav",
                            "diamond-click": "/sounds/themes/luxury-hermes/click-jewelry-sparkle.wav",
                            "door-close": "/sounds/themes/luxury-hermes/close-vault-secure.wav",
                            "message-sent": "/sounds/themes/luxury-hermes/sent-courier-delivery.wav"
                        }
                    },
                    "boeing-747": {
                        name: "🛫 Boeing 747",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/boeing-747/click-captain-command.wav",
                            "ui-click-secondary": "/sounds/themes/boeing-747/click-autopilot-engage.wav",
                            "ui-hover": "/sounds/themes/boeing-747/hover-cabin-ambience.wav",
                            "ui-toggle": "/sounds/themes/boeing-747/toggle-flight-systems.wav",
                            "navigation-forward": "/sounds/themes/boeing-747/forward-takeoff-thrust.wav",
                            "navigation-back": "/sounds/themes/boeing-747/back-approach-landing.wav",
                            "notification-success": "/sounds/themes/boeing-747/success-altitude-reached.wav",
                            "notification-error": "/sounds/themes/boeing-747/error-turbulence-warning.wav",
                            "gauge-tick": "/sounds/themes/boeing-747/tick-instrument-reading.wav",
                            "diamond-click": "/sounds/themes/boeing-747/click-first-class-luxury.wav",
                            "door-close": "/sounds/themes/boeing-747/close-cabin-seal.wav",
                            "message-sent": "/sounds/themes/boeing-747/sent-air-traffic-control.wav"
                        }
                    },
                    "space-scifi": {
                        name: "🚀 Space Sci-Fi",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/space-scifi/click-quantum-interface.wav",
                            "ui-click-secondary": "/sounds/themes/space-scifi/click-holographic-panel.wav",
                            "ui-hover": "/sounds/themes/space-scifi/hover-cosmic-resonance.wav",
                            "ui-toggle": "/sounds/themes/space-scifi/toggle-warp-drive.wav",
                            "navigation-forward": "/sounds/themes/space-scifi/forward-hyperdrive-jump.wav",
                            "navigation-back": "/sounds/themes/space-scifi/back-temporal-reverse.wav",
                            "notification-success": "/sounds/themes/space-scifi/success-mission-protocol.wav",
                            "notification-error": "/sounds/themes/space-scifi/error-system-anomaly.wav",
                            "gauge-tick": "/sounds/themes/space-scifi/tick-energy-flux.wav",
                            "diamond-click": "/sounds/themes/space-scifi/click-crystal-matrix.wav",
                            "door-close": "/sounds/themes/space-scifi/close-airlock-seal.wav",
                            "message-sent": "/sounds/themes/space-scifi/sent-subspace-transmission.wav"
                        }
                    },
                    "medical-surgical": {
                        name: "⚕️ Medical Surgical",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/medical-surgical/click-surgical-precision.wav",
                            "ui-click-secondary": "/sounds/themes/medical-surgical/click-instrument-select.wav",
                            "ui-hover": "/sounds/themes/medical-surgical/hover-sterile-environment.wav",
                            "ui-toggle": "/sounds/themes/medical-surgical/toggle-life-support.wav",
                            "navigation-forward": "/sounds/themes/medical-surgical/forward-procedure-advance.wav",
                            "navigation-back": "/sounds/themes/medical-surgical/back-diagnostic-review.wav",
                            "notification-success": "/sounds/themes/medical-surgical/success-vital-signs-stable.wav",
                            "notification-error": "/sounds/themes/medical-surgical/error-critical-alert.wav",
                            "gauge-tick": "/sounds/themes/medical-surgical/tick-heart-monitor.wav",
                            "diamond-click": "/sounds/themes/medical-surgical/click-scalpel-precision.wav",
                            "door-close": "/sounds/themes/medical-surgical/close-operating-room.wav",
                            "message-sent": "/sounds/themes/medical-surgical/sent-emergency-dispatch.wav"
                        }
                    },
                    "formula1-racing": {
                        name: "🏎️ Formula 1 Racing",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/formula1-racing/click-pit-stop-precision.wav",
                            "ui-click-secondary": "/sounds/themes/formula1-racing/click-gear-shift.wav",
                            "ui-hover": "/sounds/themes/formula1-racing/hover-engine-rev.wav",
                            "ui-toggle": "/sounds/themes/formula1-racing/toggle-drs-activation.wav",
                            "navigation-forward": "/sounds/themes/formula1-racing/forward-overtake-maneuver.wav",
                            "navigation-back": "/sounds/themes/formula1-racing/back-defensive-position.wav",
                            "notification-success": "/sounds/themes/formula1-racing/success-checkered-flag.wav",
                            "notification-error": "/sounds/themes/formula1-racing/error-yellow-flag-warning.wav",
                            "gauge-tick": "/sounds/themes/formula1-racing/tick-rpm-needle.wav",
                            "diamond-click": "/sounds/themes/formula1-racing/click-trophy-ceremony.wav",
                            "door-close": "/sounds/themes/formula1-racing/close-helmet-visor.wav",
                            "message-sent": "/sounds/themes/formula1-racing/sent-team-radio.wav"
                        }
                    },
                    "rolex-watchmaking": {
                        name: "⌚ Rolex Watchmaking",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/rolex-watchmaking/click-crown-precision.wav",
                            "ui-click-secondary": "/sounds/themes/rolex-watchmaking/click-mechanism-engage.wav",
                            "ui-hover": "/sounds/themes/rolex-watchmaking/hover-swiss-craftsmanship.wav",
                            "ui-toggle": "/sounds/themes/rolex-watchmaking/toggle-chronograph-function.wav",
                            "navigation-forward": "/sounds/themes/rolex-watchmaking/forward-time-advance.wav",
                            "navigation-back": "/sounds/themes/rolex-watchmaking/back-heritage-tradition.wav",
                            "notification-success": "/sounds/themes/rolex-watchmaking/success-certification-approval.wav",
                            "notification-error": "/sounds/themes/rolex-watchmaking/error-precision-adjustment.wav",
                            "gauge-tick": "/sounds/themes/rolex-watchmaking/tick-escapement-rhythm.wav",
                            "diamond-click": "/sounds/themes/rolex-watchmaking/click-diamond-setting.wav",
                            "door-close": "/sounds/themes/rolex-watchmaking/close-case-seal.wav",
                            "message-sent": "/sounds/themes/rolex-watchmaking/sent-master-approval.wav"
                        }
                    },
                    "shelbygt500cartier": {
                        name: "🏁 Shelby GT500 × Cartier",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/shelbygt500cartier/click-supercharged-precision.wav",
                            "ui-click-secondary": "/sounds/themes/shelbygt500cartier/click-luxury-controls.wav",
                            "ui-hover": "/sounds/themes/shelbygt500cartier/hover-engine-purr.wav",
                            "ui-toggle": "/sounds/themes/shelbygt500cartier/toggle-performance-mode.wav",
                            "navigation-forward": "/sounds/themes/shelbygt500cartier/forward-acceleration-rush.wav",
                            "navigation-back": "/sounds/themes/shelbygt500cartier/back-refined-deceleration.wav",
                            "notification-success": "/sounds/themes/shelbygt500cartier/success-lap-record.wav",
                            "notification-error": "/sounds/themes/shelbygt500cartier/error-traction-warning.wav",
                            "gauge-tick": "/sounds/themes/shelbygt500cartier/tick-speedometer-climb.wav",
                            "diamond-click": "/sounds/themes/shelbygt500cartier/click-diamond-shift-knob.wav",
                            "door-close": "/sounds/themes/shelbygt500cartier/close-carbon-fiber-door.wav",
                            "message-sent": "/sounds/themes/shelbygt500cartier/sent-track-communication.wav"
                        }
                    },
                    "luxury-premium": {
                        name: "💎 Luxury Premium",
                        sounds: {
                            "ui-click-primary": "/sounds/themes/luxury-premium/click-platinum-touch.wav",
                            "ui-click-secondary": "/sounds/themes/luxury-premium/click-gold-accent.wav",
                            "ui-hover": "/sounds/themes/luxury-premium/hover-silk-whisper.wav",
                            "ui-toggle": "/sounds/themes/luxury-premium/toggle-crystal-mechanism.wav",
                            "navigation-forward": "/sounds/themes/luxury-premium/forward-red-carpet.wav",
                            "navigation-back": "/sounds/themes/luxury-premium/back-velvet-retreat.wav",
                            "notification-success": "/sounds/themes/luxury-premium/success-champagne-toast.wav",
                            "notification-error": "/sounds/themes/luxury-premium/error-concierge-attention.wav",
                            "gauge-tick": "/sounds/themes/luxury-premium/tick-pearl-counting.wav",
                            "diamond-click": "/sounds/themes/luxury-premium/click-flawless-diamond.wav",
                            "door-close": "/sounds/themes/luxury-premium/close-mansion-entrance.wav",
                            "message-sent": "/sounds/themes/luxury-premium/sent-private-butler.wav"
                        }
                    }
                };

                console.log('✅ Sound mappings loaded successfully');
                console.log(`📊 Loaded ${Object.keys(this.soundMappings).length} themes with ${this.getTotalSoundCount()} sounds`);
            }

            getTotalSoundCount() {
                let total = 0;
                Object.values(this.soundMappings).forEach(theme => {
                    total += Object.keys(theme.sounds).length;
                });
                return total;
            }

            setupEventListeners() {
                const volumeSlider = document.getElementById('masterVolume');
                const volumeDisplay = document.getElementById('volumeDisplay');

                volumeSlider.addEventListener('input', (e) => {
                    this.masterVolume = e.target.value / 100;
                    volumeDisplay.textContent = e.target.value + '%';
                    this.updateAllVolumes();
                });
            }

            updateAllVolumes() {
                this.sounds.forEach(audio => {
                    audio.volume = this.masterVolume;
                });
            }

            renderThemes() {
                const container = document.getElementById('themesContainer');
                container.innerHTML = '';

                Object.entries(this.soundMappings).forEach(([themeId, themeData]) => {
                    const themeCard = this.createThemeCard(themeId, themeData);
                    container.appendChild(themeCard);
                });
            }

            createThemeCard(themeId, themeData) {
                const card = document.createElement('div');
                card.className = 'theme-card';
                
                const soundCount = Object.keys(themeData.sounds).length;
                
                card.innerHTML = `
                    <div class="theme-header">
                        <div class="theme-title">${themeData.name}</div>
                        <div class="theme-badge">${soundCount} sounds</div>
                    </div>
                    <div class="sounds-grid">
                        ${Object.entries(themeData.sounds).map(([soundId, soundPath]) => `
                            <div class="sound-card" id="card-${themeId}-${soundId}">
                                <div class="sound-name">${soundId.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>
                                <div class="sound-status" id="status-${themeId}-${soundId}">Ready</div>
                                <div class="sound-controls">
                                    <button class="sound-btn" onclick="soundCenter.playSound('${themeId}', '${soundId}', '${soundPath}')">▶️</button>
                                    <button class="sound-btn stop" onclick="soundCenter.stopSound('${themeId}', '${soundId}')">⏹️</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                return card;
            }

            async playSound(themeId, soundId, soundPath) {
                try {
                    const soundKey = `${themeId}-${soundId}`;
                    
                    // Update status
                    this.updateSoundStatus(themeId, soundId, 'Loading...');
                    
                    // Stop existing sound if playing
                    if (this.sounds.has(soundKey)) {
                        this.sounds.get(soundKey).pause();
                        this.sounds.get(soundKey).currentTime = 0;
                    }

                    // Create new audio element
                    const audio = new Audio(soundPath);
                    audio.volume = this.masterVolume;
                    
                    // Event listeners
                    audio.addEventListener('canplay', () => {
                        this.loadedCount++;
                        this.updateStats();
                    });

                    audio.addEventListener('play', () => {
                        this.playingSounds.add(soundKey);
                        this.updateSoundCardState(themeId, soundId, true);
                        this.updateSoundStatus(themeId, soundId, 'Playing');
                        this.updateStats();
                    });

                    audio.addEventListener('ended', () => {
                        this.playingSounds.delete(soundKey);
                        this.updateSoundCardState(themeId, soundId, false);
                        this.updateSoundStatus(themeId, soundId, 'Ready');
                        this.updateStats();
                    });

                    audio.addEventListener('error', (e) => {
                        console.error(`Failed to load sound: ${soundPath}`, e);
                        this.updateSoundStatus(themeId, soundId, 'Error');
                        this.playingSounds.delete(soundKey);
                        this.updateSoundCardState(themeId, soundId, false);
                        this.updateStats();
                    });

                    // Store and play
                    this.sounds.set(soundKey, audio);
                    await audio.play();

                } catch (error) {
                    console.error(`Error playing sound ${soundId}:`, error);
                    this.updateSoundStatus(themeId, soundId, 'Error');
                }
            }

            stopSound(themeId, soundId) {
                const soundKey = `${themeId}-${soundId}`;
                if (this.sounds.has(soundKey)) {
                    const audio = this.sounds.get(soundKey);
                    audio.pause();
                    audio.currentTime = 0;
                    this.playingSounds.delete(soundKey);
                    this.updateSoundCardState(themeId, soundId, false);
                    this.updateSoundStatus(themeId, soundId, 'Ready');
                    this.updateStats();
                }
            }

            updateSoundCardState(themeId, soundId, isPlaying) {
                const card = document.getElementById(`card-${themeId}-${soundId}`);
                if (card) {
                    if (isPlaying) {
                        card.classList.add('playing');
                    } else {
                        card.classList.remove('playing');
                    }
                }
            }

            updateSoundStatus(themeId, soundId, status) {
                const statusElement = document.getElementById(`status-${themeId}-${soundId}`);
                if (statusElement) {
                    statusElement.textContent = status;
                }
            }

            updateStats() {
                document.getElementById('totalSounds').textContent = this.getTotalSoundCount() + '+';
                document.getElementById('totalThemes').textContent = Object.keys(this.soundMappings).length.toString();
                document.getElementById('playingSounds').textContent = this.playingSounds.size.toString();
                document.getElementById('loadedSounds').textContent = this.loadedCount.toString();
            }

            setViewMode(mode) {
                this.viewMode = mode;
                document.body.className = `view-mode ${mode}`;
                
                // Update toggle buttons
                document.querySelectorAll('.toggle-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                event.target.classList.add('active');
            }

            // Edit Mode Functionality
            enableEditMode() {
                document.body.classList.add('edit-mode');
                this.originalMappings = JSON.parse(JSON.stringify(this.soundMappings));
                this.setupEditableCards();
                console.log('✏️ Edit mode enabled - click sound cards to reassign');
            }

            disableEditMode() {
                document.body.classList.remove('edit-mode');
                this.removeEditableCards();
                this.hideChangesIndicator();
                console.log('❌ Edit mode disabled');
            }

            setupEditableCards() {
                document.querySelectorAll('.sound-card').forEach(card => {
                    card.classList.add('editable');
                    card.addEventListener('click', this.handleCardEdit.bind(this));
                });
            }

            removeEditableCards() {
                document.querySelectorAll('.sound-card').forEach(card => {
                    card.classList.remove('editable');
                    card.removeEventListener('click', this.handleCardEdit.bind(this));
                });
            }

            handleCardEdit(event) {
                event.stopPropagation();
                const card = event.currentTarget;
                const cardId = card.id;
                const [_, themeId, soundId] = cardId.split('-');
                
                this.currentEditTarget = { themeId, soundId, cardId };
                this.showSoundSelector();
            }

            showSoundSelector() {
                const { themeId, soundId } = this.currentEditTarget;
                const targetSlot = document.getElementById('targetSlot');
                targetSlot.textContent = `${themeId} → ${soundId}`;
                
                this.populateAvailableSounds();
                document.getElementById('overlay').classList.add('active');
                document.getElementById('soundSelector').classList.add('active');
            }

            populateAvailableSounds() {
                const container = document.getElementById('availableSounds');
                container.innerHTML = '';
                
                // Get all unique sound files from all themes
                const allSounds = new Set();
                Object.values(this.soundMappings).forEach(theme => {
                    Object.values(theme.sounds).forEach(soundPath => {
                        allSounds.add(soundPath);
                    });
                });

                allSounds.forEach(soundPath => {
                    const soundName = soundPath.split('/').pop().replace(/\.(wav|mp3|ogg)$/, '');
                    const soundDiv = document.createElement('div');
                    soundDiv.className = 'available-sound';
                    soundDiv.innerHTML = `
                        <div style="font-weight: 600; margin-bottom: 5px;">${soundName}</div>
                        <div style="font-size: 12px; opacity: 0.7;">${soundPath}</div>
                    `;
                    soundDiv.addEventListener('click', () => this.assignSound(soundPath));
                    container.appendChild(soundDiv);
                });
            }

            assignSound(newSoundPath) {
                const { themeId, soundId, cardId } = this.currentEditTarget;
                
                // Update the mapping
                this.soundMappings[themeId].sounds[soundId] = newSoundPath;
                
                // Update the card display
                const card = document.getElementById(cardId);
                const soundName = newSoundPath.split('/').pop().replace(/\.(wav|mp3|ogg)$/, '');
                card.querySelector('.sound-name').textContent = soundName.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                
                // Update onclick handlers
                const playBtn = card.querySelector('.sound-controls button:first-child');
                playBtn.setAttribute('onclick', `soundCenter.playSound('${themeId}', '${soundId}', '${newSoundPath}')`);
                
                this.showChangesIndicator();
                this.closeSoundSelector();
                
                console.log(`🔄 Assigned ${soundName} to ${themeId} → ${soundId}`);
            }

            showChangesIndicator() {
                document.getElementById('changesIndicator').classList.add('active');
            }

            hideChangesIndicator() {
                document.getElementById('changesIndicator').classList.remove('active');
            }

            closeSoundSelector() {
                document.getElementById('overlay').classList.remove('active');
                document.getElementById('soundSelector').classList.remove('active');
                this.currentEditTarget = null;
            }

            saveConfiguration() {
                // Generate updated soundMappings.ts content
                const configContent = this.generateSoundMappingsFile();
                
                // Create download
                const blob = new Blob([configContent], { type: 'text/typescript' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'soundMappings.ts';
                a.click();
                URL.revokeObjectURL(url);
                
                // Save to localStorage as backup
                localStorage.setItem('crm-custom-sound-mappings', JSON.stringify(this.soundMappings));
                
                this.hideChangesIndicator();
                alert('✅ Configuration saved! Download the soundMappings.ts file and replace the existing one in your project.');
                
                console.log('💾 Sound configuration saved and downloaded');
            }

            generateSoundMappingsFile() {
                let content = `// Auto-generated Sound Mappings Configuration
// Generated on: ${new Date().toISOString()}

export const THEME_SOUND_OVERRIDES: Record<string, Record<string, string>> = {
`;

                Object.entries(this.soundMappings).forEach(([themeId, themeData]) => {
                    content += `  "${themeId}": {\n`;
                    Object.entries(themeData.sounds).forEach(([soundId, soundPath]) => {
                        content += `    "${soundId}": "${soundPath}",\n`;
                    });
                    content += `  },\n`;
                });

                content += `};

export const getSoundUrl = (soundId: string, themeId?: string): string => {
  const fallbackTheme = 'core';
  const currentTheme = themeId || fallbackTheme;
  
  // Check theme-specific override first
  if (THEME_SOUND_OVERRIDES[currentTheme]?.[soundId]) {
    return THEME_SOUND_OVERRIDES[currentTheme][soundId];
  }
  
  // Fallback to core sounds
  if (THEME_SOUND_OVERRIDES[fallbackTheme]?.[soundId]) {
    return THEME_SOUND_OVERRIDES[fallbackTheme][soundId];
  }
  
  // Ultimate fallback
  return \`/sounds/core/\${soundId}.wav\`;
};

export default {
  THEME_SOUND_OVERRIDES,
  getSoundUrl
};
`;
                return content;
            }

            resetToDefault() {
                if (confirm('⚠️ Reset all sounds to default mappings? This will lose all custom assignments.')) {
                    this.soundMappings = JSON.parse(JSON.stringify(this.originalMappings));
                    this.renderThemes();
                    this.hideChangesIndicator();
                    console.log('🔄 Sound mappings reset to default');
                }
            }
        }

        // Global functions
        function setViewMode(mode) {
            soundCenter.setViewMode(mode);
        }

        function toggleEditMode() {
            if (document.body.classList.contains('edit-mode')) {
                soundCenter.disableEditMode();
            } else {
                soundCenter.enableEditMode();
            }
        }

        function saveConfiguration() {
            soundCenter.saveConfiguration();
        }

        function resetToDefault() {
            soundCenter.resetToDefault();
        }

        function closeSoundSelector() {
            soundCenter.closeSoundSelector();
        }

        function testAllSounds() {
            console.log('🧪 Testing all sounds...');
            let delay = 0;
            Object.entries(soundCenter.soundMappings).forEach(([themeId, themeData]) => {
                Object.entries(themeData.sounds).forEach(([soundId, soundPath], index) => {
                    setTimeout(() => {
                        soundCenter.playSound(themeId, soundId, soundPath);
                    }, delay);
                    delay += 300; // Faster testing
                });
            });
        }

        function stopAllSounds() {
            console.log('⏹️ Stopping all sounds...');
            soundCenter.sounds.forEach((audio, soundKey) => {
                audio.pause();
                audio.currentTime = 0;
            });
            soundCenter.playingSounds.clear();
            document.querySelectorAll('.sound-card.playing').forEach(card => {
                card.classList.remove('playing');
            });
            document.querySelectorAll('.sound-status').forEach(status => {
                status.textContent = 'Ready';
            });
            soundCenter.updateStats();
        }

        function playRandomSamples() {
            console.log('🎲 Playing random samples...');
            const allSounds = [];
            Object.entries(soundCenter.soundMappings).forEach(([themeId, themeData]) => {
                Object.entries(themeData.sounds).forEach(([soundId, soundPath]) => {
                    allSounds.push({ themeId, soundId, soundPath });
                });
            });

            // Play 3 random sounds
            for (let i = 0; i < 3; i++) {
                const randomSound = allSounds[Math.floor(Math.random() * allSounds.length)];
                setTimeout(() => {
                    soundCenter.playSound(randomSound.themeId, randomSound.soundId, randomSound.soundPath);
                }, i * 1500);
            }
        }

        function exportConfiguration() {
            const config = {
                themes: Object.entries(soundCenter.soundMappings).map(([id, data]) => ({
                    id,
                    name: data.name,
                    soundCount: Object.keys(data.sounds).length,
                    sounds: Object.keys(data.sounds)
                })),
                totalSounds: soundCenter.getTotalSoundCount(),
                masterVolume: soundCenter.masterVolume,
                exportDate: new Date().toISOString(),
                viewMode: soundCenter.viewMode
            };

            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'crm-sound-configuration.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function muteAll() {
            document.getElementById('masterVolume').value = 0;
            soundCenter.masterVolume = 0;
            document.getElementById('volumeDisplay').textContent = '0%';
            soundCenter.updateAllVolumes();
        }

        function maxVolume() {
            document.getElementById('masterVolume').value = 100;
            soundCenter.masterVolume = 1;
            document.getElementById('volumeDisplay').textContent = '100%';
            soundCenter.updateAllVolumes();
        }

        function resetVolume() {
            document.getElementById('masterVolume').value = 70;
            soundCenter.masterVolume = 0.7;
            document.getElementById('volumeDisplay').textContent = '70%';
            soundCenter.updateAllVolumes();
        }

        function showAdvancedStats() {
            const stats = {
                totalSounds: soundCenter.getTotalSoundCount(),
                totalThemes: Object.keys(soundCenter.soundMappings).length,
                playingSounds: soundCenter.playingSounds.size,
                loadedSounds: soundCenter.loadedCount,
                masterVolume: Math.round(soundCenter.masterVolume * 100) + '%',
                viewMode: soundCenter.viewMode,
                memoryUsage: soundCenter.sounds.size + ' audio objects'
            };
            
            alert(`📈 Advanced Sound Statistics\n\nTotal Sounds: ${stats.totalSounds}\nThemes Available: ${stats.totalThemes}\nCurrently Playing: ${stats.playingSounds}\nLoaded in Memory: ${stats.loadedSounds}\nMaster Volume: ${stats.masterVolume}\nView Mode: ${stats.viewMode}\nMemory Usage: ${stats.memoryUsage}`);
        }

        // Initialize
        let soundCenter;
        document.addEventListener('DOMContentLoaded', () => {
            soundCenter = new SoundControlCenter();
        });
    </script>
</body>
</html>